% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PostChicagoTidyNestedRemoved.R
\name{plotInteractions}
\alias{plotInteractions}
\title{Plot Lineplots of Interactions}
\usage{
plotInteractions(
  L,
  id,
  k,
  zoom = 2e+05,
  rmapgr,
  ylim = NULL,
  show.legend = TRUE,
  d = NULL,
  preselected = FALSE,
  name = NULL,
  intervals = NULL,
  show.legend.intervals = TRUE,
  xlim = NULL,
  col = NULL,
  colintervals = NULL,
  troubleshooting = FALSE,
  lwd = 2,
  lty = NULL,
  show.legend.outside = FALSE,
  cex.intervals = 0.7,
  cex.legend = 1
)
}
\arguments{
\item{L}{List with the chicagoData tables (cd(at)x)}

\item{id}{baitID: corresponds to a specific view point.}

\item{k}{smoothing factor of the line plot (running average)}

\item{zoom}{area around the bait in +/-bp to plot, Default: 200000}

\item{rmapgr}{GenomicRanges object containing restriction fragments. IDs must be saved in a column called 'id'}

\item{ylim}{optional: limit of the y axis, usually c(0,1), Default c(0, max(all samples))}

\item{show.legend}{logical, should the sample legend be shown? Default: TRUE}

\item{d}{optional: interactions table to highlight significant interactions as transparent rectangles. Default highlights any interaction.
If different categories of interactions should be highlighted, they should be specified in a column called 'clusters_refined'. Example usage would be lost, gained and stable interactions between
two samples. Up to 8 categories can be defined which then receive a different color each. Default: NULL}

\item{preselected}{optional: are interactions in d preselected for the correct baitID?
Useful in cases when the ids in the interactions table do not match the ids in L, Default: FALSE}

\item{name}{name of the promoter to plot, optional: Default: name = baitID}

\item{intervals}{optional: intervals to be plotted as a named GenomicRangesList grl, useful for annotation of the plot with ChIP-Seq data}

\item{show.legend.intervals}{logical input, should the intervals legend be shown? Default: TRUE}

\item{xlim}{optional: x limit of the plot as xlim=c(30000,200000), overrides zoom, Default bait +/- zoom}

\item{col}{colors of lines in plot, optional: Default: 'Okabe-Ito' with a max of 9 different samples}

\item{colintervals}{colors for interval plots, optional: Default: c('grey','pink','purple','green','red','blue','orange','black','darkred','darkgreen','cornflowerblue')}

\item{troubleshooting}{if TRUE will return messages showing how far the process is, Default: FALSE}

\item{lwd}{line width, Default 2pt}

\item{lty}{optional: line type, Default: 1}

\item{show.legend.outside}{If TRUE, shows the legend outside of the plot. Default: FALSE}

\item{cex.intervals}{Defines the size of the intervals legend. Default: 0.7}

\item{cex.legend}{Defines the size of the samples legend. Default: 1}
}
\value{
Line plots of Capture-C reads surrounding one view point.
}
\description{
Plots line plots of normalized Capture-C read counts around one view point (bait) from one or many samples.
Optional annotation with genomic intervals of choice and interactions.
}
\examples{
# example code

#define directories
extdata <- system.file("extdata", package="PostChicago")
chicagoOutputDir <- file.path(extdata,'results')
designDir <- file.path(extdata,'designDir')

#create baited_genes and rmapgr:
baited_genes=baitmap2baited_genes(designDir,save=FALSE)
rmapgr=rmap2rmapgr(designDir,save=FALSE)

#load list with chicago data objects:
cdlist <- loadCdList(resultsDir = chicagoOutputDir, baited_genes = baited_genes)
cdlist=cdlist[-grep('rep',names(cdlist))]

#standard plot:
col=c('indianred1','seagreen')
name='Hoxb3'
id=baited_genes[baited_genes$genename==name]$re_id
k=15
ylim=c(0,200)
plotInteractions(cdlist,id,k,ylim=ylim,show.legend = TRUE,name=name, rmapgr=rmapgr,col=col)

#vary line type and width:
plotInteractions(cdlist,id,k,ylim=ylim,show.legend = TRUE,name=name, rmapgr=rmapgr,col=col,
    lwd=1,lty=c(1,2))

#change zoom around the bait:
plotInteractions(cdlist,id,k,ylim=ylim,show.legend = TRUE,name=name, rmapgr=rmapgr,col=col, 
    zoom=500000)

#change zoom the number of restriction fragments over which the running mean is calculated:
plotInteractions(cdlist,id,k=61,ylim=ylim,show.legend = TRUE,name=name, rmapgr=rmapgr,col=col, 
    zoom=500000)

}
