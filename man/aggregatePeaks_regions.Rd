% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PostChicagoTidyNestedRemoved.R
\name{aggregatePeaks_regions}
\alias{aggregatePeaks_regions}
\title{Aggregate Interactions to Interaction Peaks by Distance in bp}
\usage{
aggregatePeaks_regions(ints, dis, samples, fileprefix = "ints")
}
\arguments{
\item{ints}{Interactions table containing all interactions that should be aggregated}

\item{dis}{numeric in bp, fragments which lie within this distance from each other will be aggregated into regions.}

\item{samples}{Character vector of sample names, should correspond to the sample names used in ints.
Typically corresponding to the names provided in the list of chicagoData objects cd}

\item{fileprefix}{start of the filename for the aggregatePeaks table file, will be added the following extension:
paste0('_aggregatePeaks_in_regions_',dis,'bp.txt'). Should contain path if required to be saved in a different folder. Default: ints.}
}
\value{
A table containing the position of aggregated interactions. Redefines intIDs so that the ID of the
first interacting fragment in a peak stands in as otherEnd.
Data is automatically saved in a 'aggregatePeaks_dis' text file whose name is defined by fileprefix and dis.
Also saved as a bedfile.
}
\description{
Takes a table of interactions (ints) and aggregates interactions with the same bait over the distance dis in bp.
Only creates the table if it is not yet saved. Otherwise loads the existing table.
Caution: All interactions, regardless the sample from which they originated, are aggregated, similarly to the reduce() function
from GenomicRanges.
}
\examples{
# example code:
extdata <- system.file("extdata", package="PostChicago")
outputDir <- file.path(extdata,'postchicago')

#read in the interactions table:
ints=read.delim(paste0(outputDir,'/ints_all.txt'),stringsAsFactors=FALSE)

#aggregate all peaks within a distance of 5 restriction fragments
dis=5000
samples=names(ints)[grep('_N$',names(ints))]
samples=strsplit_string(samples,s2='_N')
aggregatePeaks_regions(ints,dis,samples)

}
