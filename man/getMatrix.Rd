% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PostChicagoTidyNestedRemoved.R
\name{getMatrix}
\alias{getMatrix}
\title{Create Interaction Matrices}
\usage{
getMatrix(
  L,
  zoom = 100,
  d,
  resfolder = "matrices/",
  type = "reads",
  readnorm = "downsampling",
  name = "",
  norm = FALSE,
  normsam = 1,
  pseudo = 1,
  rmapgr = rmapgr
)
}
\arguments{
\item{L}{list with chicago data objects (cd(at)x)}

\item{zoom}{distance around interaction in restriction fragments}

\item{d}{A table with cis-chromosomal interactions. Should contain the columns baitID, otherEndID, defined as in Chicago and can have a column intID, which is expected to be in the format baitID;otherEndID.
otherEndID should be the center of interaction, from which the matrices will be calculated.}

\item{resfolder}{path to the directory, where the matrices and plots should be stored,
optional, Default: 'matrices/'. Creates the directory if necessary.}

\item{type}{'reads' or 'scores'. If reads, then downsampling to the sample with the smallest amount of reads mapped to baits is
performed. Default: 'reads'}

\item{readnorm}{Read normalization, either 'downsampling' or 'scaling'. Scaling is the same as for Lineplots. Default: 'downsampling'}

\item{name}{Name of the matrix.}

\item{norm}{Logical input. Should the data be normalised?, optional: Default: TRUE}

\item{normsam}{To which sample in the list L should the data be normalised? optional: Default: 1 (the first sample!).}

\item{pseudo}{pseudocount to be added for normalisation between matrices. Default: 1}

\item{rmapgr}{GenomicRanges object containing restriction fragments. IDs must be saved in a column called 'id'}
}
\value{
List of interaction matrices (Lm), also saved in the resfolder. Loadable as Lm.
}
\description{
Function that creates, normalizes and plots matrices with reads or scores surrounding an interaction as determined in d. Interaction is always
determined as a restriction fragment to restriction fragment interaction. If interaction peaks or interval peaks are used, it is advised
to either determine the peak summit or the central fragment that overlaps an interval.
CAUTION: Only creates a matrix if the matrix doesn't exist yet in the specified resfolder
The function outputs a list with interaction matrices and distance-matched control matrices (con). For each interaction the control is considered to be
an interaction between the same promoter and a fragment at the same distance (in restriction fragments) on the opposite side of this promoter.
Output matrices are stranded, such that the promoter is to the right (+ direction) of the interaction. The matrices are saved as rds in the resfolder and can be loaded later.
Figures (png) are saved in the same folder. Before recalculating the matrices the function checks the resfolder if they exist. In that case the matrices are loaded and only the figures are recreated.
Normalised matrices are calculated from unnormalised matrices if they exist.
Normalisation happens to the center of interaction in the reference sample normsam. Normsam is recommended to be a positive control, expected to have the highest values in the samples.
Plots can be interpreted as fraction of interaction strength compared to the center of interaction in sample normsam.
}
