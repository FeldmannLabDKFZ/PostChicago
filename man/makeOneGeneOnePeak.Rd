% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PostChicagoTidyNestedRemoved.R
\name{makeOneGeneOnePeak}
\alias{makeOneGeneOnePeak}
\title{Make one-Gene-one-Peak Interaction Table}
\usage{
makeOneGeneOnePeak(grl, rmapgr, ints, maxgap = 1000, folder = "oneGeneOnePeak")
}
\arguments{
\item{grl}{GRangesList containing features with which ints should be annotated.
Names of the grl correspond to the names that will be given to table columns}

\item{rmapgr}{GenomicRanges object containing restriction fragments. IDs must be saved in a column called 'id'}

\item{ints}{chicago data over interactions (as returned by getInts)}

\item{maxgap}{minimum gap for two different peaks/maximum separation for two maxima to be binned together, optional: Default 1000}

\item{folder}{Output folder}
}
\value{
annotated OneGeneOnePeak interaction table as .txt.
}
\description{
This function takes intervals in grl, gives them a unique ID and identifies all interaction with a given interval.
}
\examples{
# example code

#define directories:
extdata <- system.file("extdata", package="PostChicago")
outputDir <- file.path(extdata,'postchicago')
designDir <- file.path(extdata,'designDir')
intDir <- file.path(extdata,'intervals')

#read in the interactions file
ints=read.delim(paste0(outputDir,'/ints_all.txt'))

#construct rmapgr
rmapgr=rmap2rmapgr(designDir,save=FALSE)

#construct grl
grl <- suppressWarnings(loadGrl(intDir = intDir))

#create oneGeneOnePeak tables
quantfolder=paste0(outputDir,'/oneGeneOnePeak')
makeOneGeneOnePeak(grl = grl,rmapgr = rmapgr, ints = ints, folder = quantfolder, maxgap=1000)

}
